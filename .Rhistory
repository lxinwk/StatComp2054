cla<-unique(all_near[,2])
probs<-matrix(cla,ncol=2,nrow=length(cla),byrow=FALSE)
k_nearest<-all_near[1:k,]
freqs<-as.data.frame(table(k_nearest[,2]))
freqs[,2]<-freqs[,2]/k
#probs[,2]=probs[,2]/k
colnames(freqs)<-c("class","probs")
freqs<-freqs[order(freqs[,2],decreasing = TRUE),]
re <- freqs[1,]
re
}
knn_classi<-function(train_data,obse,type,calcols,classcol,idcol,k)
{
distance<-function(train_data,obse,type)
{
r<-nrow(train_data)
near_distance<-matrix(nrow=r,ncol=1)
for(i in 1:r){
near_distance[i]<-norm(cbind(train_data[i,]-obse),type)#zhao
}
return (near_distance)
}
knn<-function(train_data,obse,type,calcols,classcol,idcol)
{
d<-distance(train_data[,calcols],obse,type)
m <- data.frame(train_data[,idcol],train_data[,classcol],d)
return(m)
}
all_near<-knn(train_data,obse,type,calcols,classcol,idcol)
all_near<-all_near[order(all_near[,3]),]
r<-nrow(all_near)
cla<-unique(all_near[,2])
probs<-matrix(cla,ncol=2,nrow=length(cla),byrow=FALSE)
k_nearest<-all_near[1:k,]
freqs<-as.data.frame(table(k_nearest[,2]))
freqs[,2]<-freqs[,2]/k
#probs[,2]=probs[,2]/k
colnames(freqs)<-c("class","probs")
freqs<-freqs[order(freqs[,2],decreasing = TRUE),]
re <- freqs[1,]
re
}
knn_classi(iris,c(11,22),'2',c(2:3),4,1,5)#c(121,203)
knn_classi<-function(train_data,obse,type,calcols,classcol,idcol,k)
{
distance<-function(train_data,obse,type)
{
r<-nrow(train_data)
near_distance<-matrix(nrow=r,ncol=1)
for(i in 1:r){
near_distance[i]<-norm(cbind(train_data[i,]-obse),type)#zhao
}
near_distance
}
knn<-function(train_data,obse,type,calcols,classcol,idcol)
{
d<-distance(train_data[,calcols],obse,type)
m <- data.frame(train_data[,idcol],train_data[,classcol],d)
m
}
all_near<-knn(train_data,obse,type,calcols,classcol,idcol)
all_near<-all_near[order(all_near[,3]),]
r<-nrow(all_near)
cla<-unique(all_near[,2])
probs<-matrix(cla,ncol=2,nrow=length(cla),byrow=FALSE)
k_nearest<-all_near[1:k,]
freqs<-as.data.frame(table(k_nearest[,2]))
freqs[,2]<-freqs[,2]/k
#probs[,2]=probs[,2]/k
colnames(freqs)<-c("class","probs")
freqs<-freqs[order(freqs[,2],decreasing = TRUE),]
re <- freqs[1,]
re
}
knn_classi(iris,c(11,22),'2',c(2:3),4,1,5)#c(121,203)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
rm(list = c("knn_classi"))
devtools::document()
devtools::build_vignettes()
Type .Last.error.trace
.Last.error.trace
devtools::build()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::check()
devtools::build()
install.packages('E:/Rcpp/StatComp-2020-12-16/StatComp20054_1.0.tar.gz',repo=NULL)
install.packages('E:/Rcpp/StatComp-2020-12-16/StatComp20054_1.0.tar.gz',repo=NULL)
devtools::document()
devtools::check()
devtools::check()
devtools::build_vignettes()
devtools::check()
devtools::build()
devtools::document()
devtools::check()
df1<-read.csv("df1.txt",stringsAsFactors = F)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
blast_RIdeogram <- function(df1,df2){
library(magrittr)
suppressPackageStartupMessages(library("dplyr"))
library("rsvg")
df3<-df2[,c(3,7,8,9,10)]
df3$fill<-ifelse(df3$V3>90,"0080cc",
ifelse(df3$V3<80,"0ab276","e64e60"))
df3$Species_1<-1
df3$Species_2<-1
df4 <- df3 %>%
select(Species_1,V7,V8,Species_2,V9,V10,fill)
colnames(df4)<-colnames(synteny_dual_comparison)
ideogram(karyotype =df1 ,
synteny=df4,output = "blast_RIdeogram.svg")
rsvg_pdf("blast_RIdeogram.svg","blast_RIdeogram.pdf")
}
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
blast_RIdeogram <- function(df1,df2){
library(RIdeogram)
data(karyotype_dual_comparison)
library(magrittr)
suppressPackageStartupMessages(library("dplyr"))
library("rsvg")
df3<-df2[,c(3,7,8,9,10)]
df3$fill<-ifelse(df3$V3>90,"0080cc",
ifelse(df3$V3<80,"0ab276","e64e60"))
df3$Species_1<-1
df3$Species_2<-1
df4 <- df3 %>%
select(Species_1,V7,V8,Species_2,V9,V10,fill)
colnames(df4)<-colnames(synteny_dual_comparison)
ideogram(karyotype =df1 ,
synteny=df4,output = "blast_RIdeogram.svg")
rsvg_pdf("blast_RIdeogram.svg","blast_RIdeogram.pdf")
}
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
blast_circlize(df,df1)
blast_circlize(df,df1)
blast_circlize(df,df1)
blast_circlize <- function(df,df1){
suppressPackageStartupMessages(library(circlize))
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
col<-RColorBrewer::brewer.pal(6,"Paired")
circos.par("start.degree" = 130)
circos.initialize(factors = df$chr,x=df$x)
circos.trackPlotRegion(factors = df$chr,y=df$y,
panel.fun = function(x,y){
circos.axis()
},track.height = 0.1)
highlight.sector(sector.index = "chloroplast",col=col[1])
highlight.sector(sector.index = "mitochondrial",col=col[2])
circos.text(x=70000,y=0.5,
labels = "chloroplast",
sector.index = "chloroplast")
circos.text(x=220000,y=0.5,
labels = "mitochondrial",
sector.index = "mitochondrial",
facing = "outside")
col_fun = colorRamp2(c(70,90,100),
c("green", "yellow", "red"))
for (i in 1:13){
x<-sort(c(df1[i,8],df1[i,7]))
y<-sort(c(df1[i,10],df1[i,9]))
z<-df1[i,3]
circos.link("chloroplast",x,"mitochondrial",y,
col=add_transparency(col_fun(z)))
}
circos.clear()
lgd_links = Legend(at = c(70, 80, 90, 100),
col_fun = col_fun,
title_position = "topleft",
title = "identity(%)")
lgd_list_vertical = packLegend(lgd_links)
draw(lgd_list_vertical, x = unit(10, "mm"),
y = unit(10, "mm"), just = c("left", "bottom"))
}
blast_circlize(df,df1)
blast_circlize(df,df3)
blast_circlize <- function(df,df1){
suppressPackageStartupMessages(library(circlize))
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
col<-RColorBrewer::brewer.pal(6,"Paired")
circos.par("start.degree" = 130)
circos.initialize(factors = df$chr,x=df$x)
circos.trackPlotRegion(factors = df$chr,y=df$y,
panel.fun = function(x,y){
circos.axis()
},track.height = 0.1)
highlight.sector(sector.index = "chloroplast",col=col[1])
highlight.sector(sector.index = "mitochondrial",col=col[2])
circos.text(x=70000,y=0.5,
labels = "chloroplast",
sector.index = "chloroplast")
circos.text(x=220000,y=0.5,
labels = "mitochondrial",
sector.index = "mitochondrial",
facing = "outside")
col_fun = colorRamp2(c(70,90,100),
c("green", "yellow", "red"))
for (i in 1:13){
x<-sort(c(df1[i,8],df1[i,7]))
y<-sort(c(df1[i,10],df1[i,9]))
z<-df1[i,3]
circos.link("chloroplast",x,"mitochondrial",y,
col=add_transparency(col_fun(z)))
}
circos.clear()
lgd_links = Legend(at = c(70, 80, 90, 100),
col_fun = col_fun,
title_position = "topleft",
title = "identity(%)")
lgd_list_vertical = packLegend(lgd_links)
draw(lgd_list_vertical, x = unit(10, "mm"),
y = unit(10, "mm"), just = c("left", "bottom"))
}
blast_circlize(df,df3)
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
df3
blast_circlize <- function(df,df1){
col<-RColorBrewer::brewer.pal(6,"Paired")
circos.par("start.degree" = 130)
circos.initialize(factors = df$chr,x=df$x)
circos.trackPlotRegion(factors = df$chr,y=df$y,
panel.fun = function(x,y){
circos.axis()
},track.height = 0.1)
highlight.sector(sector.index = "chloroplast",col=col[1])
highlight.sector(sector.index = "mitochondrial",col=col[2])
circos.text(x=70000,y=0.5,
labels = "chloroplast",
sector.index = "chloroplast")
circos.text(x=220000,y=0.5,
labels = "mitochondrial",
sector.index = "mitochondrial",
facing = "outside")
col_fun = colorRamp2(c(70,90,100),
c("green", "yellow", "red"))
for (i in 1:13){
x<-sort(c(df1[i,8],df1[i,7]))
y<-sort(c(df1[i,10],df1[i,9]))
z<-df1[i,3]
circos.link("chloroplast",x,"mitochondrial",y,
col=add_transparency(col_fun(z)))
}
circos.clear()
lgd_links = Legend(at = c(70, 80, 90, 100),
col_fun = col_fun,
title_position = "topleft",
title = "identity(%)")
lgd_list_vertical = packLegend(lgd_links)
draw(lgd_list_vertical, x = unit(10, "mm"),
y = unit(10, "mm"), just = c("left", "bottom"))
}
blast_circlize(df,df1)
devtools::check()
devtools::build_vignettes()
devtools::check()
devtools::build()
devtools::install_github('lxinwk/StatComp20054')
devtools::install_github('lxinwk/StatComp20054')
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df3<-read.csv("output6.txt",stringsAsFactors = F,header=F,sep=" ")
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
blast_RIdeogram <- function(df1,df2){
library(RIdeogram)#
library(magrittr)
suppressPackageStartupMessages(library("dplyr"))
library("rsvg")
df3<-df2[,c(3,7,8,9,10)]
df3$fill<-ifelse(df3$V3>90,"0080cc",
ifelse(df3$V3<80,"0ab276","e64e60"))
df3$Species_1<-1
df3$Species_2<-1
df4 <- df3 %>%
select(Species_1,V7,V8,Species_2,V9,V10,fill)
colnames(df4)<-colnames(synteny_dual_comparison)
ideogram(karyotype =df1 ,
synteny=df4,output = "blast_RIdeogram.svg")
rsvg_pdf("blast_RIdeogram.svg","blast_RIdeogram.pdf")
}
df1<-read.csv("df1.txt",stringsAsFactors = F)
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
blast_RIdeogram(df1,df2)
df1<-read.csv("df1.txt",stringsAsFactors = F)
df1
df2<-read.csv("output6.txt",header=F,sep=" ",stringsAsFactors = F)
df2
blast_RIdeogram(df1,df2)
df1<-data.frame(Chr=c("I","I"),
Start=c(1,1),
End=c(131478,444567),
fill=c("FF9D1E","FF9D1E"),
species=c("chloroplast","mitochondrion"),
size=c(12,12),
color=c(252525,252525))
df1
df2<-data.frame(V1=c(rep("NC_044701",13)),
V2=c(rep("NC_044768",13)),
V3=c(96.76,83.69,85.28,74.07,90.54,95.56,96.51,96.43,94.94,96.77,87.34,100.00,96.97)
V4=c(1603,423,326,891,148,90,86,84,79,62,79,31,33)
df2<-data.frame(V1=c(rep("NC_044701",13)),
V2=c(rep("NC_044768",13)),
V3=c(96.76,83.69,85.28,74.07,90.54,95.56,96.51,96.43,94.94,96.77,87.34,100.00,96.97),
V4=c(1603,423,326,891,148,90,86,84,79,62,79,31,33),
V5=c(43,37,38,172,11,3,2,3,4,2,6,0,0),
V6=c(7,19,5,45,3,1,1,0,0,0,3,0,1),
V7=c(54477,68192,66335,102938,36180,49,110947,31738,53913,105594,88210,10365,66299),
V8=c(56074,68587,66654,103801,36324,138,111032,31821,53991,105655,88284,10395,66330),
V9=c(375799,44003,360145,332888,64144,406657,420751,384266,2926,110375,240028,63403,360093),
V10=c(374201,44420,360466,333746,64291,406745,420667,384349,3004,110314,240106,63373,360125),
V11=c(0.0,2e-101,1e-88,1e-83,4e-48,4e-33,2e-32,5e-32,2e-27,2e-21,2e-16,2e-07,2e-06),
V12=c(2663,370,327,311,193,143,141,139,124,104,87.9,58.4,54.7))
df2
df1<-data.frame(Chr=c("I","I"),
Start=c(1,1),
End=c(131478,444567),
fill=c("FF9D1E","FF9D1E"),
species=c("chloroplast","mitochondrion"),
size=c(12,12),
color=c(252525,252525))
df2<-data.frame(V1=c(rep("NC_044701",13)),
V2=c(rep("NC_044768",13)),
V3=c(96.76,83.69,85.28,74.07,90.54,95.56,96.51,96.43,94.94,96.77,87.34,100.00,96.97),
V4=c(1603,423,326,891,148,90,86,84,79,62,79,31,33),
V5=c(43,37,38,172,11,3,2,3,4,2,6,0,0),
V6=c(7,19,5,45,3,1,1,0,0,0,3,0,1),
V7=c(54477,68192,66335,102938,36180,49,110947,31738,53913,105594,88210,10365,66299),
V8=c(56074,68587,66654,103801,36324,138,111032,31821,53991,105655,88284,10395,66330),
V9=c(375799,44003,360145,332888,64144,406657,420751,384266,2926,110375,240028,63403,360093),
V10=c(374201,44420,360466,333746,64291,406745,420667,384349,3004,110314,240106,63373,360125),
V11=c(0.0,2e-101,1e-88,1e-83,4e-48,4e-33,2e-32,5e-32,2e-27,2e-21,2e-16,2e-07,2e-06),
V12=c(2663,370,327,311,193,143,141,139,124,104,87.9,58.4,54.7))
blast_RIdeogram(df1,df2)
library(RIdeogram)#
head(karyotype_dual_comparison)
head(synteny_dual_comparison)
blast_RIdeogram <- function(df1,df2){
library(RIdeogram)#
library(magrittr)
suppressPackageStartupMessages(library("dplyr"))
library("rsvg")
df3<-df2[,c(3,7,8,9,10)]
df3$fill<-ifelse(df3$V3>90,"0080cc",
ifelse(df3$V3<80,"0ab276","e64e60"))
df3$Species_1<-1
df3$Species_2<-1
df4 <- df3 %>%
select(Species_1,V7,V8,Species_2,V9,V10,fill)
colnames(df4)<-colnames(synteny_dual_comparison)
ideogram(karyotype =df1 ,
synteny=df4,output = "blast_RIdeogram.svg")
rsvg_pdf("blast_RIdeogram.svg","blast_RIdeogram.pdf")
}
df1<-data.frame(Chr=c("I","I"),
Start=c(1,1),
End=c(131478,444567),
fill=c("FF9D1E","FF9D1E"),
species=c("chloroplast","mitochondrion"),
size=c(12,12),
color=c(252525,252525))
df2<-data.frame(V1=c(rep("NC_044701",13)),
V2=c(rep("NC_044768",13)),
V3=c(96.76,83.69,85.28,74.07,90.54,95.56,96.51,96.43,94.94,96.77,87.34,100.00,96.97),
V4=c(1603,423,326,891,148,90,86,84,79,62,79,31,33),
V5=c(43,37,38,172,11,3,2,3,4,2,6,0,0),
V6=c(7,19,5,45,3,1,1,0,0,0,3,0,1),
V7=c(54477,68192,66335,102938,36180,49,110947,31738,53913,105594,88210,10365,66299),
V8=c(56074,68587,66654,103801,36324,138,111032,31821,53991,105655,88284,10395,66330),
V9=c(375799,44003,360145,332888,64144,406657,420751,384266,2926,110375,240028,63403,360093),
V10=c(374201,44420,360466,333746,64291,406745,420667,384349,3004,110314,240106,63373,360125),
V11=c(0.0,2e-101,1e-88,1e-83,4e-48,4e-33,2e-32,5e-32,2e-27,2e-21,2e-16,2e-07,2e-06),
V12=c(2663,370,327,311,193,143,141,139,124,104,87.9,58.4,54.7))
blast_RIdeogram(df1,df2)
df<-data.frame(chr=c(rep("chloroplast",2),rep("mitochondrial",2)),
x=c(1,131478,1,444567),
y=c(0,1,0,1))
df
df3 <-df2
df3 <-df2
df3
blast_circlize <- function(df,df1){
suppressPackageStartupMessages(library(circlize))#RIdeogram,magrittr,dplyr,rsvg,circlize,RColorBrewer,ComplexHeatmap
library(RColorBrewer)
suppressPackageStartupMessages(library(ComplexHeatmap))
col<-RColorBrewer::brewer.pal(6,"Paired")
circos.par("start.degree" = 130)
circos.initialize(factors = df$chr,x=df$x)
circos.trackPlotRegion(factors = df$chr,y=df$y,
panel.fun = function(x,y){
circos.axis()
},track.height = 0.1)
highlight.sector(sector.index = "chloroplast",col=col[1])
highlight.sector(sector.index = "mitochondrial",col=col[2])
circos.text(x=70000,y=0.5,
labels = "chloroplast",
sector.index = "chloroplast")
circos.text(x=220000,y=0.5,
labels = "mitochondrial",
sector.index = "mitochondrial",
facing = "outside")
col_fun = colorRamp2(c(70,90,100),
c("green", "yellow", "red"))
for (i in 1:13){
x<-sort(c(df1[i,8],df1[i,7]))
y<-sort(c(df1[i,10],df1[i,9]))
z<-df1[i,3]
circos.link("chloroplast",x,"mitochondrial",y,
col=add_transparency(col_fun(z)))
}
circos.clear()
lgd_links = Legend(at = c(70, 80, 90, 100),
col_fun = col_fun,
title_position = "topleft",
title = "identity(%)")
lgd_list_vertical = packLegend(lgd_links)
draw(lgd_list_vertical, x = unit(10, "mm"),
y = unit(10, "mm"), just = c("left", "bottom"))
}
blast_circlize(df,df3)
devtools::document()
rm(list = c("blast_circlize", "blast_RIdeogram")
devtools::document()
rm(list = c("blast_circlize", "blast_RIdeogram"))
devtools::document()
devtools::check()
devtools::build_vignettes()
devtools::check()
devtools::build()
